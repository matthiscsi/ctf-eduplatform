<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CTF Portaal</title>
    <style>
      :root { color-scheme: light dark; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 2rem; color: #1f2937; line-height: 1.5; }
      @media (prefers-color-scheme: dark) { body { color: #e5e7eb; background: #0b1220; } .card { border-color: #263247; background:#111827; color:#e5e7eb; } .muted { color:#9aa4b2; } details.section { border-color:#263247; } details.section[open] { background:#111827; } }
      h1 { font-size: 1.8rem; margin: .25rem 0 1rem; }
      .wrap { max-width: 980px; margin: 0 auto; }
      .ascii { position:relative; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size: 14px; line-height: 1.05; background: #0f172a; color: #e2e8f0; padding: 12px 16px; border-radius: 12px; overflow:hidden; box-shadow: 0 8px 25px rgba(2,6,23,.25); }
      .ascii::-webkit-scrollbar { display: none; }
      .ascii::before { content:""; position:absolute; inset:0; pointer-events:none; background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.15), transparent 40%),
        radial-gradient(1.5px 1.5px at 80% 20%, rgba(255,255,255,.12), transparent 40%),
        radial-gradient(1.8px 1.8px at 60% 70%, rgba(255,255,255,.12), transparent 40%),
        radial-gradient(1.2px 1.2px at 35% 80%, rgba(255,255,255,.10), transparent 40%),
        radial-gradient(1.6px 1.6px at 10% 60%, rgba(255,255,255,.08), transparent 40%);
        animation: twinkle 6s infinite ease-in-out; }
      .ascii::after { content:""; position:absolute; inset:0; pointer-events:none; background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,.10) 20%, transparent 40%); transform: translateX(-100%); animation: shine 5s infinite; }
      @keyframes twinkle { 0%,100% { opacity:.6 } 50% { opacity:1 } }
      @keyframes shine { 0% { transform: translateX(-100%);} 100% { transform: translateX(100%);} }
      .subtitle { margin:.5rem 0 1.5rem; color:#6b7280; }
      .section-title { margin: .1rem 0; font-weight: 800; font-size: 1.45rem; }
      details.section { border:1px solid #e5e7eb; border-radius:12px; padding: .6rem .9rem; margin: 1rem 0; }
      details.section[open] { background: #f9fafb; }
      details.section summary.section-title { list-style:none; cursor:pointer; user-select:none; display:flex; align-items:center; gap:.4rem; }
      details.section summary.section-title::-webkit-details-marker { display:none; }
      .caret { display:inline-block; transform: rotate(0deg); transition: transform .15s ease; }
      details[open] .caret { transform: rotate(90deg); }
      .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px; }
      .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 1rem 1.25rem; background:#ffffff; color:#111827; }
      .card h2 { margin: 0 0 .25rem; font-size: 1.1rem; }
      .card p { margin: 0 0 .75rem; }
      a.button { display: inline-block; padding: .55rem .85rem; background: #2563eb; color: white; border-radius: 8px; text-decoration: none; transition: transform .05s ease, background-color .15s ease; border: 1px solid #1d4ed8; font-weight:600; }
      a.button:hover { transform: translateY(-1px); background:#1e40af; border-color:#1e40af; }
      a.button:focus-visible { outline: 3px solid #93c5fd; outline-offset: 2px; }
      a.button.spoilers { background:#7c3aed; border-color:#6d28d9; }
      a.button.spoilers:hover { background:#6d28d9; border-color:#6d28d9; }
      a.button.spoilers:focus-visible { outline-color:#c4b5fd; }
      .cta-row { display:flex; gap:.6rem; justify-content:flex-start; align-items:center; margin:.75rem 0 1.1rem; }
      .badge { display:inline-flex; align-items:center; gap:.35rem; font-size:.85rem; padding:.2rem .5rem; border-radius:999px; }
      .ok { background:#ecfdf5; color:#065f46; border:1px solid #a7f3d0; }
      .fail { background:#fef2f2; color:#991b1b; border:1px solid #fecaca; }
      .check { font-weight:700; }
      .flag-box { margin:1.25rem 0; border:1px solid #e5e7eb; border-radius:12px; padding:1rem 1.25rem; }
      .flag-row { display:flex; gap:.5rem; }
      .flag-row input { flex:1; padding:.6rem .7rem; border:1px solid #cbd5e1; border-radius:8px; }
      .flag-row button { padding:.6rem .9rem; background:#111827; color:#fff; border:none; border-radius:8px; cursor:pointer; }
      .msg { margin-top:.6rem; }
      code { background: #f3f4f6; color: #111827; padding: .1rem .25rem; border-radius: 4px; }
      @media (prefers-color-scheme: dark) {
        code { background: #111827; color: #e2e8f0; }
      }

      /* Ensure readable contrast when sections are expanded (dark mode override placed after base rules) */
      @media (prefers-color-scheme: dark) {
        .card { background:#0f172a; color:#e5e7eb; border-color:#263247; }
        details.section { border-color:#263247; }
        details.section[open] { background:#0f172a; }
        .flag-box { background:#0f172a; border-color:#263247; color:#e5e7eb; }
        a.button.spoilers { background:#8b5cf6; border-color:#7c3aed; }
        a.button.spoilers:hover { background:#7c3aed; border-color:#7c3aed; }
      }
      footer { margin-top: 2rem; font-size: .85rem; color: #9ca3af; }
      .muted { color:#6b7280; font-size:.9rem; }
      .copy { padding:.4rem .6rem; border:1px solid #cbd5e1; background:#fff; border-radius:6px; cursor:pointer; }
      .copy:hover { background:#f3f4f6; }
      @media (prefers-color-scheme: dark){ .copy{ background:#0f172a; color:#e5e7eb; border-color:#263247; } .copy:hover{ background:#111827; } }
    </style>
  </head>
  <body>
    <div class="wrap">
      <pre class="ascii" aria-hidden="true">
                          __                           __  .__               _____.__                  
      ____ _____  _______/  |_ __ _________   ____   _/  |_|  |__   ____   _/ ____\  | _____     ____  
    _/ ___\\__  \ \____ \   __\  |  \_  __ \\_/ __ \  \   __\  |  \_/ __ \  \   __\|  | \__  \   / ___\ 
    \  \___ / __ \|  |_> >  | |  |  /|  | \/\  ___/   |  | |   Y  \  ___/   |  |  |  |__/ __ \_/ /_/  >
     \___  >____  /   __/|__| |____/ |__|    \___  >  |__| |___|  /\___  >  |__|  |____(____  /\___  / 
         \/     \/|__|                           \/             \/     \/                   \/\/_____/  
      </pre>
      <h1>De enige echte CTF Portaal</h1>
      <p class="subtitle">Welkom! Start elke challenge en deel de poorten. Deze apps zijn opzettelijk kwetsbaar â€” voor educatieve doeleinden in een sandbox. Bugs op de site zijn features met ambitie.</p>
      

      <div class="flag-box">
        <h2 style="margin:0 0 .5rem;">Dien je key in</h2>
        <form method="post">
          <div class="flag-row">
            <input type="text" name="flag" placeholder="CTF{...}" aria-label="Flag" required>
            <button type="submit">Controleren</button>
          </div>
        </form>
        {% with msgs = get_flashed_messages(with_categories=true) %}
          {% if msgs %}
            <div class="msg">
              {% for category, text in msgs %}
                {% if category == 'ok' %}
                  <span class="badge ok"><span class="check">âœ“</span> {{ text }}</span>
                {% else %}
                  <span class="badge fail"><span class="check">âœ—</span> {{ text }}</span>
                {% endif %}
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
      </div>

      <details class="section" open>
        <summary class="section-title"><span class="caret">â–¶</span> Starters</summary>
        <div class="grid">
          <div class="card">
            <h2>1) Onveilige login (SQLi)
              {% if 'login-sqli' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>Omzeil de login met SQL-injectie. De vlag verschijnt wanneer je ingelogd bent als <code>admin</code>.</p>
            <a class="button" href="{{ login_url }}" target="_blank">Openen login-sqli</a>
          </div>

          <div class="card">
            <h2>2) Zwakke JWT
              {% if 'jwt-weak' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>Misbruik een zwakke geheime sleutel, word <code>admin</code> en haal de vlag op.</p>
            <a class="button" href="{{ jwt_url }}" target="_blank">Openen jwt-weak</a>
          </div>

          <div class="card">
            <h2>3) Statische geheimen
              {% if 'static-secrets' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>Zoek naar aanwijzingen en vergeten bestanden. Hints zijn optioneel.</p>
            <a class="button" href="{{ static_url }}" target="_blank">Openen static-secrets</a>
          </div>
        </div>
      </details>

      <details class="section">
        <summary class="section-title"><span class="caret">â–¶</span> Advanced</summary>
        <div class="grid">
          <div class="card">
            <h2>4) Command Injection
              {% if 'command-injection' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>Een netwerk diagnostiek tool die ping commando's uitvoert. Kun je meer dan alleen pingen?</p>
            <a class="button" href="{{ cmd_injection_url }}" target="_blank">Openen command-injection</a>
          </div>

          <div class="card">
            <h2>5) SSRF Internal
              {% if 'ssrf-internal' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>Een URL preview service. Welke interne endpoints kun je bereiken?</p>
            <a class="button" href="{{ ssrf_url }}" target="_blank">Openen ssrf-internal</a>
          </div>

          <div class="card">
            <h2>6) XML XXE
              {% if 'xxe-injection' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>Een XML import service. XML parsers kunnen gevaarlijk zijn...</p>
            <a class="button" href="{{ xxe_url }}" target="_blank">Openen xml-xxe</a>
          </div>

          <div class="card">
            <h2>7) SSH Brute Force
              {% if 'brute-ssh' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>Een SSH server met zwakke credentials. Gebruik tools zoals <code>hydra</code> of <code>nmap</code>.</p>
            <span class="badge fail" style="margin-bottom:0.75rem;"><span class="check">âš </span> Tijdelijk buiten gebruik</span>
            <p><code id="ssh-cmd">ssh -p 2222 ctfuser@35.210.32.202</code> <button class="copy" type="button" aria-label="Copy SSH command" title="Copy SSH command" onclick="navigator.clipboard.writeText(document.getElementById('ssh-cmd').textContent); this.textContent='âœ“ Copied'; setTimeout(()=>this.textContent='Copy',1200);">Copy</button></p>
          </div>
        </div>
      </details>

      <details class="section">
        <summary class="section-title"><span class="caret">â–¶</span> Hacking God</summary>
        <div class="grid">
          <div class="card">
            <h2>8) Container Breakout (docker.sock)
              {% if 'container-breakout' in (solved or []) %}
                <span class="badge ok" style="margin-left:.5rem;"><span class="check">âœ“</span> Opgelost</span>
              {% endif %}
            </h2>
            <p>SSRF naar de Docker Remote API op een interne dind-host. Start een container met bind-mount van <code>/</code> en lees de host-flag.</p>
            <a class="button" href="{{ breakout_url }}" target="_blank" aria-label="Openen container-breakout">Openen container-breakout</a>
          </div>
        </div>
      </details>

      <p class="muted" style="margin-top:1.25rem;">Elke service heeft een health-endpoint op <code>/healthz</code>.</p>

      <p style="margin-top:1rem;"><a class="button spoilers" href="/solutions" aria-label="Bekijk oplossingen (spoilers)" title="Bekijk oplossingen (spoilers)">ðŸ“– Bekijk oplossingen (spoilers!)</a></p>

      <footer>
        Cybersecurity Project <span style="letter-spacing:.02em;">-Matthias-</span> en <span style="letter-spacing:.02em;">-Sefkan-</span>
      </footer>
    </div>
  </body>
  </html>
